<html>

<head>
    <script src="../data/wahoo.js"></script>
    <script src="../dist/TableProxy-0.9.0.js"></script>
</head>

<body>
    <div id='table'></div>
    <div id='New Sheet'></div>
    <script>
        var t;
        window.addEventListener("load", function () {
            console.log(DATA);
            SpreadsheetApp.div = document.getElementById('table');
            SpreadsheetApp.setFakeData(DATA.rawData.dataObject);
            SpreadsheetApp.getActiveSpreadsheet().getSheetByName('Test');


            $initTableProxy('TP');
            var opts = JSON.parse('{"spreadsheetId":123,"sheetName":"Test","headerAnchorToken":null,"exportAttributes":["value","fontcolor","fontsize"],"writeLevel":"WRITE_LEVEL_CELL","autoResizeColumns":false,"computedProperties":{},"idColumnName":"C1","idAttributeName":"value"}');
            t = TP.mount(opts);
            //t = TP.mount('Test').setExportAttributes(['value','fontcolor']).setComputedProperties({
            //    fart: function(){return `${this.C2.value} + ${this.C3.value}`;}
            //});
            var query = function (r) {
                if (this.C3.value.indexOf('4-3') !== -1) {

                    r.C3.value = new Date();
                    r['C3'].background = 'red'; //OK
                    r['C3'].fontsize = 20; //OK
                    r['C3'].fontweight = 'bold'; //OK
                    r['C5'].note = 'fuckoff';
                    r['C3'].fontfamily = 'Georgia'; //OK
                    r['C3'].fontstyle = 'italic'; //OK
                    r['C4'].fontcolor = 'green';

                    return true;
                }
            }
            //t.select(query,true);
            //console.log(JSON.stringify(t.getExportObject()));


            //var records = JSON.parse('[{"C1":{"value":"2-1 Value","fontcolor":"blue","fontsize":10},"2-2 Value":{"value":"3-2 Value","fontcolor":"#000000","fontsize":10},"2-3 Value":{"value":"3-3 Value","fontcolor":"#000000","fontsize":10},"2-4 Value":{"value":"3-4 Value","fontcolor":"#000000","fontsize":10},"2-5 Value":{"value":"3-5 Value","fontcolor":"#000000","fontsize":10}},{"2-1 Value":{"value":"4-1 Value","fontcolor":"#000000","fontsize":10},"2-2 Value":{"value":"4-2 Value","fontcolor":"#000000","fontsize":10},"2-3 Value":{"value":"4-3 Value","fontcolor":"#000000","fontsize":10},"2-4 Value":{"value":"4-4 Value","fontcolor":"#000000","fontsize":10},"2-5 Value":{"value":"4-5 Value","fontcolor":"#000000","fontsize":10}},{"2-1 Value":{"value":"5-1 Value","fontcolor":"#000000","fontsize":10},"2-2 Value":{"value":"5-2 Value","fontcolor":"#000000","fontsize":10},"2-3 Value":{"value":"5-3 Value","fontcolor":"#000000","fontsize":10},"2-4 Value":{"value":"5-4 Value","fontcolor":"#000000","fontsize":10},"2-5 Value":{"value":"5-5 Value","fontcolor":"#000000","fontsize":10}},{"2-1 Value":{"value":"6-1 Value","fontcolor":"#000000","fontsize":10},"2-2 Value":{"value":"6-2 Value","fontcolor":"#000000","fontsize":10},"2-3 Value":{"value":"6-3 Value","fontcolor":"#000000","fontsize":10},"2-4 Value":{"value":"6-4 Value","fontcolor":"#000000","fontsize":10},"2-5 Value":{"value":"6-5 Value","fontcolor":"#000000","fontsize":20}}]');
            //console.log(JSON.stringify(t.writeRecords(records)));

            //console.log(JSON.stringify(t.writeRecords(records).getExportObject(true)));

        });

        function z() {
            s.getRange(4, 3, 2, 2).setBackgrounds([['blue', 'green'], ['orange', 'purple']]);
        }




    </script>




</body>

</html>